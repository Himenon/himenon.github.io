<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Firebaseことはじめ | 技術の定点観測</title>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css">
    <link rel="stylesheet" href="/pc.css?hoge1">
    <link rel="stylesheet" href="/tablet.css?hoge1">
    <link rel="stylesheet" href="/sp.css?hoge2">
    <link rel="stylesheet" href="/prism.css">
</head>

<body>
    <header class="site-header">
        <h1><a href="">技術の定点観測</a></h1>
    </header>
    <div class="container">
        <div class="site-nav">
            <h2>サイト内トピック</h2>
            
    <ul>
    
        <li class="most-deep-item"><a href="../..">Hey!</a>
</li>
    
        <li class="most-deep-item"><a href="../../pick-up-article/">Pick Up Article</a>
</li>
    
        <li ><span><b><u>Django</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Django/Add new app/">DjangoにAppを新たに追加したときにやること</a>
</li>
      <li class="most-deep-item"><a href="../../Django/Introduction-of-Celery-Django/">Django 2.0にCelery 4.0を導入し、WEBの管理画面でCronを管理する</a>
</li>
      <li class="most-deep-item"><a href="../../Django/Seperate-Django-Database/">Djangoで複数のデータベースを利用する</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Firebase</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../Auth-Error-Tips/">FirebaseのAuthで躓いたこと</a>
</li>
      <li class="most-deep-item"><a href="../Firebase-Cloud-Functions/">FirebaseにおけるCloud Functions</a>
</li>
      <li class="most-deep-item"><a href="./">Firebaseことはじめ</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Flask</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Flask/Hello-Flask-Streamming-Content/">Hello Flask Streamming Content</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Frontend</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Frontend/settings/">Settings</a>
</li>
      <li ><span><b><u>Es6</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Frontend/es6/usage-axios/">Usage axios</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Vuejs</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Frontend/vuejs/my-vue-setup/">My vue setup</a>
</li>
      <li class="most-deep-item"><a href="../../Frontend/vuejs/nuxtjs/">Nuxtjs</a>
</li>
      <li class="most-deep-item"><a href="../../Frontend/vuejs/ssr-cache-investigation/">Ssr cache investigation</a>
</li>
      <li class="most-deep-item"><a href="../../Frontend/vuejs/vuex-usage/">Vuex usage</a>
</li>
  </ul>
</li>

  </ul>
</li>

    
        <li ><span><b><u>GCP</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../GCP/Cloud-Function/">Cloud Function</a>
</li>
      <li class="most-deep-item"><a href="../../GCP/GKE/">GKE</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Infrastructure</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Infrastructure/Multiple-Reverse-Proxy-Sapmle-with-oauth2_proxy/">Multiple Reverse Proxy Sapmle with oauth2 proxy</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Nodejs</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Nodejs/Request-library-description-for-json-value/">Request library description for json value</a>
</li>
      <li class="most-deep-item"><a href="../../Nodejs/dynamic-import/">Dynamic import</a>
</li>
      <li class="most-deep-item"><a href="../../Nodejs/execute-async-mjs/">Execute async mjs</a>
</li>
      <li class="most-deep-item"><a href="../../Nodejs/manage-npm-package/">Manage npm package</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Poem</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Poem/Container-App-Directory-Management-Consideration/">Container App Directory Management Consideration</a>
</li>
      <li class="most-deep-item"><a href="../../Poem/Container-Worker-Design/">Container Worker Design</a>
</li>
      <li class="most-deep-item"><a href="../../Poem/TDD/">TDD</a>
</li>
      <li class="most-deep-item"><a href="../../Poem/read-basic-knowledge-of-nosql/">Read basic knowledge of nosql</a>
</li>
      <li class="most-deep-item"><a href="../../Poem/static-site-generator/">Static site generator</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Profile</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Profile/github-activity/">Github activity</a>
</li>
      <li class="most-deep-item"><a href="../../Profile/">Home</a>
</li>
      <li class="most-deep-item"><a href="../../Profile/skill/">Skill</a>
</li>
      <li class="most-deep-item"><a href="../../Profile/study-history/">Study history</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Tools</u></b></span>
</li>
<li>
  <ul>
      <li ><span><b><u>Cookiecutter</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Tools/Cookiecutter/usage/">Usage</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Git</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Tools/Git/git-tips/">Git tips</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Github</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Tools/Github/Github-GraphQL/">Github GraphQL</a>
</li>
      <li class="most-deep-item"><a href="../../Tools/Github/Github-Multi-Login-User/">Github Multi Login User</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Slack</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Tools/Slack/slack-library/">Slack library</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Zapier</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../Tools/Zapier/zapier-development/">Zapier development</a>
</li>
  </ul>
</li>

  </ul>
</li>

    
        <li ><span><b><u>Analytics</u></b></span>
</li>
<li>
  <ul>
      <li ><span><b><u>Jupyter</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../analytics/jupyter/change-jupyter-config-dir/">Change jupyter config dir</a>
</li>
  </ul>
</li>

      <li ><span><b><u>Pandas</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../analytics/pandas/pandas-convert-column-to-datetime/">Pandas convert column to datetime</a>
</li>
      <li class="most-deep-item"><a href="../../analytics/pandas/visualize-time/">Visualize time</a>
</li>
  </ul>
</li>

  </ul>
</li>

    
        <li ><span><b><u>Event</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../event/2018-05-21-Cloud-Native/">2018 05 21 Cloud Native</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Kubernetes</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../kubernetes/Nginx access control for kubernetes/">Nginx access control for kubernetes</a>
</li>
      <li class="most-deep-item"><a href="../../kubernetes/Shortcut-for-kubectl/">Shortcut for kubectl</a>
</li>
      <li class="most-deep-item"><a href="../../kubernetes/cron-wake-up-down/">Cron wake up down</a>
</li>
      <li class="most-deep-item"><a href="../../kubernetes/error helm incompatible version/">Error helm incompatible version</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>mongoDB</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../mongoDB/basic-query/">Basic query</a>
</li>
      <li class="most-deep-item"><a href="../../mongoDB/basic-read-write/">Basic read write</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Presentation</u></b></span>
</li>
<li>
  <ul>
      <li ><span><b><u>2018</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../presentation/2018/03-02-Yoidore-GCPUG-LT/">03 02 Yoidore GCPUG LT</a>
</li>
  </ul>
</li>

  </ul>
</li>

    
        <li ><span><b><u>Python</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../python/test-know-how/">Test know how</a>
</li>
  </ul>
</li>

    
        <li ><span><b><u>Raspberrypi</u></b></span>
</li>
<li>
  <ul>
      <li class="most-deep-item"><a href="../../raspberrypi/os-install/">Os install</a>
</li>
      <li class="most-deep-item"><a href="../../raspberrypi/purchace/">Purchace</a>
</li>
  </ul>
</li>

    
    </ul>

        </div>
        <div class="content">
            <div class="content-header">
<a href="https://twitter.com/share?ref_src=twsrc%5Etfw"
   class="twitter-share-button"
   data-text="Firebaseことはじめ"
   data-via="himenoglyph"
   data-related="himenoglyph"
   data-show-count="true">Tweet</a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

            </div>
            <div class="content-body">
    <h1 id="firebase">Firebaseことはじめ<a class="headerlink" href="#firebase" title="Permanent link">&para;</a></h1>
<h2 id="_1">事前準備<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><a href="https://firebase.google.com/docs/cli/">https://firebase.google.com/docs/cli/</a></p>
<pre><code>npm install -g firebase-tools
</code></pre>

<h2 id="samples">Samples<a class="headerlink" href="#samples" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/firebase/functions-samples">https://github.com/firebase/functions-samples</a></li>
</ul>
<h2 id="tutorial">Tutorial<a class="headerlink" href="#tutorial" title="Permanent link">&para;</a></h2>
<pre><code>firebase login
</code></pre>

<pre><code>firebase init
# 選択肢
# Projectの選択
</code></pre>

<p>まずは空デプロイ</p>
<pre><code>firebase deploy
</code></pre>

<h2 id="_2">テスト環境<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>jestを用いる</p>
<pre><code class="bash">$ npm install -D jest @types/jest sinon ts-jest
</code></pre>

<p>package.jsonに書きを追記</p>
<pre><code class="json">&quot;jest&quot;: {
&quot;moduleFileExtensions&quot;: [
  &quot;ts&quot;,
  &quot;tsx&quot;,
  &quot;js&quot;
],
&quot;testMatch&quot;: [
  &quot;**/**/tests/*.+(ts|tsx|js)&quot;  // ここはご自由に
],
&quot;transform&quot;: {
  &quot;^.+\\.tsx?$&quot;: &quot;ts-jest&quot;
},
&quot;globals&quot;: {
  &quot;ts-jest&quot;: {
    &quot;tsConfigFile&quot;: &quot;tsconfig.json&quot;
  }
}
}
</code></pre>

<h2 id="web">WEB側の作成<a class="headerlink" href="#web" title="Permanent link">&para;</a></h2>
<p>https://firebase.google.com/docs/web/setup?hl=ja</p>
<pre><code class="javascript">&lt;script src=&quot;https://www.gstatic.com/firebasejs/4.9.0/firebase.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  // Initialize Firebase
  // TODO: Replace with your project's customized code snippet
  var config = {
    apiKey: &quot;&lt;API_KEY&gt;&quot;,
    authDomain: &quot;&lt;PROJECT_ID&gt;.firebaseapp.com&quot;,
    databaseURL: &quot;https://&lt;DATABASE_NAME&gt;.firebaseio.com&quot;,
    storageBucket: &quot;&lt;BUCKET&gt;.appspot.com&quot;,
    messagingSenderId: &quot;&lt;SENDER_ID&gt;&quot;,
  };
  firebase.initializeApp(config);
&lt;/script&gt;
</code></pre>

<ul>
<li>API_KEY: </li>
<li>PROJECT_ID: </li>
<li>DATABASE_NAME:</li>
</ul>
<h2 id="_3">環境変数の設定<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>config側からぶっこむ</p>
<pre><code class="js">const webpack = require('webpack')
config.plugins.push(
  new webpack.EnvironmentPlugin(['APIKEY', 'AUTHDOMAIN', 'DATABASEURL', 'PROJECTID', 'STORAGEBUCKET', 'MESSAGINGSENDERID'])
)
</code></pre>

<h2 id="firestore">Firestoreで躓く<a class="headerlink" href="#firestore" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://stackoverflow.com/questions/46636255/firebase-firestore-is-not-a-function-when-trying-to-initialize-cloud-firestore">firebase.firestore() is not a function when trying to initialize Cloud Firestore</a></li>
</ul>
<p>firestoreのUnitttest</p>
<p>適当に<code>GCLOUD_PROJECT</code>を設定しておく必要がある。</p>
<pre><code>process.env.GCLOUD_PROJECT = 'xxxxxx'
</code></pre>

<ul>
<li>https://github.com/firebase/functions-samples/issues/250</li>
<li>https://www.npmjs.com/package/cross-env</li>
</ul>
<h2 id="cloud_function">Cloud Functionの分割<a class="headerlink" href="#cloud_function" title="Permanent link">&para;</a></h2>
<p>https://stackoverflow.com/questions/43486278/how-do-i-structure-cloud-functions-for-firebase-to-deploy-multiple-functions-fro</p>
<p>https://stackoverflow.com/questions/46818082/error-http-error-400-the-request-has-errors-firebase-firestore-cloud-function</p>

            </div>
        </div>
        <div class="page-nav">
            <h2>ページ内目次</h2>
            <ul>
    
    <li><a href="#firebase">Firebaseことはじめ</a></li>
    
    <li><a href="#_1">事前準備</a></li>
    
    <li><a href="#samples">Samples</a></li>
    
    <li><a href="#tutorial">Tutorial</a></li>
    
    <li><a href="#_2">テスト環境</a></li>
    
    <li><a href="#web">WEB側の作成</a></li>
    
    <li><a href="#_3">環境変数の設定</a></li>
    
    <li><a href="#firestore">Firestoreで躓く</a></li>
    
    <li><a href="#cloud_function">Cloud Functionの分割</a></li>
    
    
</ul>
        </div>
    </div>
    <script src="/prism.js"></script>
    <script src="/mermaid.min.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-55455343-7', 'himenon.github.io');
ga('send', 'pageview');
</script>
</body>

</html>