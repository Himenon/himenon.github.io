<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>NOSQLとは何か... | 技術の定点観測</title>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css">
    <link rel="stylesheet" href="/pc.css">
    <link rel="stylesheet" href="/tablet.css">
    <link rel="stylesheet" href="/sp.css">
    <link rel="stylesheet" href="/prism.css">
</head>
<body>
    <header class="site-header"><h1><a href="https://himenon.github.io/">技術の定点観測</a></h1></header>
    <div class="container">
        <div class="site-nav"><h2>サイト内トピック</h2><ul><li class="most-deep-item"><a href="https://himenon.github.io/../..">Hey!</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../pick-up-article/">Pick Up Article</a></li><li><span><b><u>Django</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Django/Add new app/">DjangoにAppを新たに追加したときにやること</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Django/Introduction-of-Celery-Django/">Django 2.0にCelery 4.0を導入し、WEBの管理画面でCronを管理する</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Django/Seperate-Django-Database/">Djangoで複数のデータベースを利用する</a></li></ul></li><li><span><b><u>Firebase</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Firebase/Auth-Error-Tips/">FirebaseのAuthで躓いたこと</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Firebase/Firebase-Cloud-Functions/">FirebaseにおけるCloud Functions</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Firebase/Firebase-Starter/">Firebaseことはじめ</a></li></ul></li><li><span><b><u>Flask</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Flask/Hello-Flask-Streamming-Content/">Flaskのストリーミングを利用してみる</a></li></ul></li><li><span><b><u>Frontend</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/settings/">lodash</a></li><li><span><b><u>Es6</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/es6/usage-axios/">Axiosでasync/awaitを利用する</a></li></ul></li><li><span><b><u>Vuejs</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/vuejs/my-vue-setup/">Vueのセットアップ</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/vuejs/nuxtjs/">Nuxt.jsをやる</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/vuejs/ssr-cache-investigation/">VuejsのSSR(Server Side Rendering)のページ・部分キャッシュは何で実装できるか</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Frontend/vuejs/vuex-usage/">VuexのModuleの使い方</a></li></ul></li></ul></li><li><span><b><u>GCP</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../GCP/Cloud-Function/">Cloud Function</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../GCP/GKE/">GKEのコマンド</a></li></ul></li><li><span><b><u>Infrastructure</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Infrastructure/Multiple-Reverse-Proxy-Sapmle-with-oauth2_proxy/">複数のホストをoauth2_proxyを用いてOAuth認証してリバースプロキシする</a></li></ul></li><li><span><b><u>Nodejs</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Nodejs/Request-library-description-for-json-value/">nodeのrequestライブラリの`json`オプションの取り扱いについて</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Nodejs/dynamic-import/">PackageのDynamic Import</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Nodejs/execute-async-mjs/">Module jsで非同期関数を実行する</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Nodejs/manage-npm-package/">npmのpaackage管理について</a></li></ul></li><li><span><b><u>Poem</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../Container-App-Directory-Management-Consideration/">コンテナアプリケーション作成時のディレクトリ成長設計の考察</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../Container-Worker-Design/">コンテナ型のワーカーの設計（仮）</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../TDD/">TDDポエム</a></li><li class="most-deep-item"><a href="https://himenon.github.io/./">NOSQLとは何か...</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../static-site-generator/">Static site generator</a></li></ul></li><li><span><b><u>Profile</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Profile/github-activity/">Github activity</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Profile/">Home</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Profile/skill/">Skill</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Profile/study-history/">Study history</a></li></ul></li><li><span><b><u>Tools</u></b></span></li><li><ul><li><span><b><u>Cookiecutter</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Cookiecutter/usage/">Usage</a></li></ul></li><li><span><b><u>Git</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Git/git-tips/">Git tips</a></li></ul></li><li><span><b><u>Github</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Github/Github-GraphQL/">Github GraphQL</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Github/Github-Multi-Login-User/">Github Multi Login User</a></li></ul></li><li><span><b><u>Slack</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Slack/slack-library/">Slack library</a></li></ul></li><li><span><b><u>Zapier</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../Tools/Zapier/zapier-development/">Zapier development</a></li></ul></li></ul></li><li><span><b><u>Analytics</u></b></span></li><li><ul><li><span><b><u>Jupyter</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../analytics/jupyter/change-jupyter-config-dir/">Change jupyter config dir</a></li></ul></li><li><span><b><u>Pandas</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../analytics/pandas/pandas-convert-column-to-datetime/">Pandas convert column to datetime</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../analytics/pandas/visualize-time/">Visualize time</a></li></ul></li></ul></li><li><span><b><u>Event</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../event/2018-05-21-Cloud-Native/">2018 05 21 Cloud Native</a></li></ul></li><li><span><b><u>Kubernetes</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../kubernetes/Nginx access control for kubernetes/">Nginx access control for kubernetes</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../kubernetes/Shortcut-for-kubectl/">Shortcut for kubectl</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../kubernetes/cron-wake-up-down/">Cron wake up down</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../kubernetes/error helm incompatible version/">Error helm incompatible version</a></li></ul></li><li><span><b><u>mongoDB</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../mongoDB/basic-query/">Basic query</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../mongoDB/basic-read-write/">Basic read write</a></li></ul></li><li><span><b><u>Presentation</u></b></span></li><li><ul><li><span><b><u>2018</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../presentation/2018/03-02-Yoidore-GCPUG-LT/">03 02 Yoidore GCPUG LT</a></li></ul></li></ul></li><li><span><b><u>Python</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../python/test-know-how/">Test know how</a></li></ul></li><li><span><b><u>Raspberrypi</u></b></span></li><li><ul><li class="most-deep-item"><a href="https://himenon.github.io/../../raspberrypi/os-install/">Os install</a></li><li class="most-deep-item"><a href="https://himenon.github.io/../../raspberrypi/purchace/">Purchace</a></li></ul></li></ul></div>
        <div class="content">
            <div class="content-header">
<a href="https://twitter.com/share?ref_src=twsrc%5Etfw"
   class="twitter-share-button"
   data-text="NOSQLとは何か..."
   data-via="himenoglyph"
   data-related="himenoglyph"
   data-show-count="true">Tweet</a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
            <div class="content-body"><h1 id="nosql">NOSQLとは何か...<a class="headerlink" href="#nosql" title="Permanent link">&para;</a></h1>
<p id="created_at">作成日: <time datetime="2018-02-24T23:00">2018/02/24</time></p>

<p>NOSQLの知識が欲しかったので、ちょっと古いが次の本を読んだ。</p>
<blockquote>
<p><strong>NOSQLの基礎知識 (ビッグデータを活かすデータベース技術)</strong></p>
<ul>
<li>作者: 本橋信也,河野達也,鶴見利章,太田洋</li>
<li>出版社/メーカー: リックテレコム</li>
<li>発売日: 2012/04/25</li>
<li>http://www.ric.co.jp/book/contents/book_887.html</li>
</ul>
</blockquote>
<p>逆引き的に自分なりにまとめておく。</p>
<p>ただし、出版日が数年前なだけあって、既に古いと思われる部分はなるべく書かないか、
明記しておく。</p>
<h2 id="_1">逆引き<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">ビッグデータ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>小さなデータが膨大に集まって、全体として大きなデータとなっているもの</p>
<h3 id="_3">ラージオブジェクト<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>1つのファイルサイズが大きいもの</p>
<h3 id="_4">結果整合性<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>ビッグデータ環境</p>
<h3 id="sql">SQL<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h3>
<p>行と列で構成されるテーブル形</p>
<ul>
<li>MySQL</li>
<li>Postgres</li>
</ul>
<h3 id="kvs">KVS<a class="headerlink" href="#kvs" title="Permanent link">&para;</a></h3>
<p>KeyとValueの組からなるデータ</p>
<ul>
<li>Redis</li>
<li>Dynamo</li>
</ul>
<h3 id="_5">カラム指向型<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>Key/Value形式を拡張したもので、行だけでなく、列に対して
動的に追加することができる。</p>
<ul>
<li>BigTable</li>
</ul>
<h3 id="_6">ドキュメント思考型<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>JSON、BSOM、XMLといったデータ記述書式で記されたドキュメント型</p>
<ul>
<li>CouchDB</li>
<li>MongoDB</li>
</ul>
<h3 id="_7">スケールアップ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>サーバーのハードウェア自体の強化</p>
<h3 id="_8">スケールアウト<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>サーバー自体の数を増やす</p>
<h3 id="_9">シャーディング<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>複数のサーバーにデータを分割する方法</p>
<h3 id="cap">CAP定理<a class="headerlink" href="#cap" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>C</strong>onsistency: 整合性</li>
<li><strong>A</strong>vailability: 可用性</li>
<li><strong>P</strong>artitions: 分断耐性</li>
</ul>
<p>分散システムにおいて、C、A、Pの3つのうち最大で2つしか満たすことができない、という定理</p>
<p><a href="https://ja.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86">CAP定理 - Wikipedia</a></p>
<h3 id="acid">ACID<a class="headerlink" href="#acid" title="Permanent link">&para;</a></h3>
<p>トランザクションの実行保証をするために、
データベースに求められる4つの特性</p>
<ul>
<li><strong>A</strong>tomicity（原子性）</li>
<li><strong>C</strong>onsistency（一貫性）</li>
<li><strong>I</strong>solation（独立性）</li>
<li><strong>D</strong>urability（耐久性）</li>
</ul>
<p><a href="https://ja.wikipedia.org/wiki/ACID_(%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E7%A7%91%E5%AD%A6)">ACID (コンピュータ科学) - Wikipedia</a></p>
<h3 id="base">BASE<a class="headerlink" href="#base" title="Permanent link">&para;</a></h3>
<blockquote>
<p>BASEとは、「アプリケーションは基本的にどんなときでも動き(Basicallly Available)、常に整合性を保つ必要はないが(Soft-state)、結果として整合性がとれる状態に至る(Eventual Consistency)という特性」<br />
p83</p>
</blockquote>
<ul>
<li><strong>B</strong>asically <strong>A</strong>vailable</li>
<li><strong>S</strong>oft-state</li>
<li><strong>E</strong>ventual Consistencty</li>
</ul>
<h3 id="quorum">Quorum(クォーラム)<a class="headerlink" href="#quorum" title="Permanent link">&para;</a></h3>
<p>議決に必要な定足数。</p>
<ul>
<li>N: レプリカの数</li>
<li>R: ノードから読み出す数</li>
<li>W: ノードに書き込む数</li>
</ul>
<pre><code>R + W &gt; Nの場合には整合性が保証できる。
</code></pre>

<p><code>R+W</code>がノード数より大きい場合、<strong>結果的に</strong>書き込みが完了したデータを読み込むことができる、ということ。</p>
<h3 id="vector_clockstimestamp">ベクタークロック(Vector Clocks)/タイムスタンプ(Timestamp)<a class="headerlink" href="#vector_clockstimestamp" title="Permanent link">&para;</a></h3>
<p>複数のクライアントからの同時更新があった場合に、
どのようにデータのバージョンを管理し、最終的な仲裁を行うか、
という課題に対する、代表的な解決方法。</p>
<p><strong>タイムスタンプ</strong></p>
<ul>
<li>「新しいものが勝つ」という方法。</li>
<li>サーバー側、クライアント側のどちらでも決定して良い。</li>
</ul>
<p><strong>ベクタークロック</strong></p>
<p>整合性を確保する際に用いる手法の1つ。</p>
<ul>
<li>http://www.atmarkit.co.jp/ait/articles/1211/05/news007_3.html</li>
</ul>
<h3 id="consistent_hashing">コンシステント・ハッシング(Consistent Hashing)<a class="headerlink" href="#consistent_hashing" title="Permanent link">&para;</a></h3>
<p>ノードをリング状に配置し、ハッシュ値を元に
それらのノードに書き込みを行っていく方法。
キーの値が特定の値に偏ることなく拡散するようにする。</p>
<h3 id="log_structured_merge_tree_lsm-tree">Log Structured Merge Tree (LSM-Tree)<a class="headerlink" href="#log_structured_merge_tree_lsm-tree" title="Permanent link">&para;</a></h3>
<p>Bigtableに触発されたNOSQLのデータベースが含む技術。
メモリを使って応答性能を高めながら、ハードディスクにデータを書くのすることで、データの安全性を保つ。</p>
<p>メリット</p>
<ul>
<li>書き込み性能が非常に高い</li>
</ul>
<p>デメリット</p>
<ul>
<li>読み込み性能の低下(※おそらくHDDの場合。SSDは話が変わる)</li>
</ul>
<p>読み込み性能を低下を軽減させるために、定期的にコンパクションを行い、
SS Tableの数を少なくする。</p>
<h3 id="mem_table">Mem table<a class="headerlink" href="#mem_table" title="Permanent link">&para;</a></h3>
<p>メモリーキャッシュ領域に存在。</p>
<h3 id="commit_log">Commit Log<a class="headerlink" href="#commit_log" title="Permanent link">&para;</a></h3>
<p>履歴情報をディスク内で保持</p>
<h3 id="ss_table">SS Table<a class="headerlink" href="#ss_table" title="Permanent link">&para;</a></h3>
<p>永続ボリュームに格納</p>
<h3 id="meta_data">メタデータ(Meta Data)テーブル<a class="headerlink" href="#meta_data" title="Permanent link">&para;</a></h3>
<h3 id="_10">ルートテーブル<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<h3 id="cascheck_and_swap">CAS(Check And Swap)<a class="headerlink" href="#cascheck_and_swap" title="Permanent link">&para;</a></h3>
<p>ある値の更新時に、その値が自分以外のプロセスによって更新されていないか確認し、
自分のみが更新していると確認できた上で、更新処理を適用するオペレーション。</p>
<h3 id="hadoop_mapreduce">Hadoop MapReduce<a class="headerlink" href="#hadoop_mapreduce" title="Permanent link">&para;</a></h3>
<blockquote>
<p>複数のサーバーを用いて、大量のデータを並列分散処理するプログラミングのためのソフトウェア
ある一定期間のデータを集めた上で一括処理するために用いられる。<br />
p121</p>
</blockquote>
<h3 id="hdfshadoop_distributed_file_system">HDFS(Hadoop Distributed File System)<a class="headerlink" href="#hdfshadoop_distributed_file_system" title="Permanent link">&para;</a></h3>
<p>マスタ型。MapReduceのデータ入出力として使用したトキに、最大の性能を発揮するように設計されている。</p>
<h3 id="mapreduce">MapReduce処理<a class="headerlink" href="#mapreduce" title="Permanent link">&para;</a></h3>
<p><strong>Mapタスク</strong></p>
<p>データを分解して必要な情報を抽出し、有用な形へ変換する役割</p>
<p>分散処理することで、現実的な時間で処理が終わる</p>
<p><strong>Reduceタスク</strong></p>
<p>抽出された情報を集約し、一塊のデータとして出力する役割</p>
<h2 id="todo">TODO<a class="headerlink" href="#todo" title="Permanent link">&para;</a></h2>
<p>図の挿入</p>
<h2 id="_11">最後に<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>!!! note
    誤植・間違い、もっとこうした方がいい、僕はこうやった（ドヤァ）、などありましたら、
    やさしく鎌を<a href="https://twitter.com/himenoglyph">Twitter</a>などに投げていただけると幸いです。</p></div>
        </div>
        <div class="page-nav"><h2>ページ内目次</h2><ul>
    
    <li><a href="#nosql">NOSQLとは何か...</a></li>
    
    <li><a href="#_1">逆引き</a></li>
    
    <li><a href="#todo">TODO</a></li>
    
    <li><a href="#_11">最後に</a></li>
    
    
</ul></div>
    </div>
    <script src="/prism.js"></script>
    <script src="/mermaid.min.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-55455343-7', 'himenon.github.io');
ga('send', 'pageview');
</script>
</body>
</html>