<html>

  <head lang="ja">
    <title>Dockerで利用するコマンド例</title>
    <meta charSet="utf-8" />
    <meta name="keywords" content="docker,shortcut" />
    <meta name="description" content="コピペで動くコマンドを書き連ねる" />
    <meta name="copyright" content="@Himenon" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@Himenon" />
    <meta property="og:title" content="Dockerで利用するコマンド例" />
    <meta property="og:url" content="https://himenon.github.io/docker/command" />
    <meta property="og:description" content="コピペで動くコマンドを書き連ねる" />
    <meta property="og:image" content="https://himenon.github.io/assets/images/miku.png" />
    <meta name="viewport" content="initial-scale=1,minimum-scale=0.5,user-scalable=no" />
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/miku.png?c19f3" />
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png?66034" />
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png?92c0f" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:600,800?09916" rel="stylesheet" />
    <link href="/lib/prism.css?7a36e" rel="stylesheet" />
    <link href="/assets/stylesheets/styles.css?02629" rel="stylesheet" />
    <script>
      (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
          m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-55455343-7', 'auto');
      ga('send', 'pageview');
    </script>
    <script id="csr-props" data-csr-props="{&quot;htmlMetaData&quot;:{&quot;lang&quot;:&quot;ja&quot;,&quot;title&quot;:&quot;Dockerで利用するコマンド例&quot;,&quot;description&quot;:&quot;コピペで動くコマンドを書き連ねる&quot;,&quot;keywords&quot;:&quot;docker,shortcut&quot;,&quot;copyright&quot;:&quot;@Himenon&quot;,&quot;viewport&quot;:{&quot;initial-scale&quot;:1,&quot;minimum-scale&quot;:0.5,&quot;user-scalable&quot;:&quot;no&quot;},&quot;thirdParty&quot;:{&quot;googleAnalytics&quot;:{&quot;ua&quot;:&quot;UA-55455343-7&quot;}},&quot;js&quot;:[],&quot;css&quot;:[&quot;https://fonts.googleapis.com/css?family=Open+Sans:600,800&quot;,&quot;./node_modules/prismjs/themes/prism.css&quot;,&quot;/assets/stylesheets/styles.css&quot;],&quot;link&quot;:[{&quot;rel&quot;:&quot;apple-touch-icon&quot;,&quot;sizes&quot;:&quot;180x180&quot;,&quot;href&quot;:&quot;assets/images/miku.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;32x32&quot;,&quot;href&quot;:&quot;assets/images/favicon-32x32.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;16x16&quot;,&quot;href&quot;:&quot;assets/images/favicon-16x16.png&quot;}],&quot;createdAt&quot;:&quot;2018-09-13T04:06:08.000Z&quot;,&quot;updatedAt&quot;:&quot;2019-05-21T09:35:05.000Z&quot;,&quot;globalScripts&quot;:[],&quot;globalLinks&quot;:[{&quot;rel&quot;:&quot;apple-touch-icon&quot;,&quot;sizes&quot;:&quot;180x180&quot;,&quot;href&quot;:&quot;/assets/images/miku.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;32x32&quot;,&quot;href&quot;:&quot;/assets/images/favicon-32x32.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;16x16&quot;,&quot;href&quot;:&quot;/assets/images/favicon-16x16.png&quot;},&quot;https://fonts.googleapis.com/css?family=Open+Sans:600,800&quot;,&quot;/lib/prism.css&quot;,&quot;/assets/stylesheets/styles.css&quot;],&quot;localLinks&quot;:[],&quot;extend&quot;:{&quot;meta&quot;:[{&quot;name&quot;:&quot;twitter:card&quot;,&quot;content&quot;:&quot;summary&quot;},{&quot;name&quot;:&quot;twitter:site&quot;,&quot;content&quot;:&quot;@Himenon&quot;},{&quot;property&quot;:&quot;og:title&quot;,&quot;content&quot;:&quot;Dockerで利用するコマンド例&quot;},{&quot;property&quot;:&quot;og:url&quot;,&quot;content&quot;:&quot;https://himenon.github.io/docker/command&quot;},{&quot;property&quot;:&quot;og:description&quot;,&quot;content&quot;:&quot;コピペで動くコマンドを書き連ねる&quot;},{&quot;property&quot;:&quot;og:image&quot;,&quot;content&quot;:&quot;https://himenon.github.io/assets/images/miku.png&quot;}]}},&quot;page&quot;:{&quot;uri&quot;:&quot;/docker/command&quot;,&quot;content&quot;:&quot;\n使っているときは、こんなの覚えているし（笑）\nと思っていたんですが、3か月使わなくなって忘れてしまったので、メモ帳から取り出します。\n\n## 起動中のコンテナプロセスの確認\n\n```bash\ndocker ps\n# sizeも表示する場合\ndocker ps -s\n```\n\n```bash\ndocker-compose ps\n```\n\n\n## コンテナ内でコマンドの実行\n\n```bash\ndocker exec -it [container id] [command]\n\n# ユーザーを指定\ndocker exec -it --user [desired_user] [container id] [command]\n```\n\n```bash\n# 起動していない場合\ndocker-compose run [container name] [command]\n\n# すでに起動している場合\ndocker-compose exec [container name] [command]\n```\n\n### 検証用に一発コマンドでpureな環境に入る\n\n```bash\ndocker run -it --rm alpine:3.3 /bin/sh\ndocker run -it --rm centos:7 /bin/bash\ndocker run -it --rm ubuntu:14.04 /bin/bash\n```\n\n\n* 参考：[Ubuntu や Alpine Linux をワンコマンドで瞬時に立ち上げる](https://qiita.com/dtan4/items/3be396665f9305428f4f)\n\n## イメージの停止・削除\n\n### すべてのdocker psを停止\n\n```bash\n# bash, zsh\ndocker stop $(docker ps -a -q)\n\n# fish\ndocker stop (docker ps -a -q)\n```\n\n### コンテナの削除\n\n```bash\ndocker rmi `docker images -q`\ndocker rm -f `docker ps -a -q`\n\n# fish\ndocker rm -f (docker ps -a -q)\n```\n\n### Docker psのNoneを消す\n\n```bash\n# bash\ndocker rmi $(docker images -f \&quot;dangling=true\&quot; -q)\n\n# fish\ndocker rmi (docker images -f \&quot;dangling=true\&quot; -q)\n\ndocker images | awk &#x27;/&lt;none/{print $3}&#x27; | xargs docker rmi\n```\n\n### docker-composeの場合\n\n```bash\ndocker-compose stop\ndocker-compose rm\n```\n\n## Volume系\n\n### データの永続化\n\n開発環境で、MySQLとかのバックアップ撮っておきたいなというとき。\n\n#### コンテナにホストのディレクトリをマウントする\n\n現在いるディレクトリをサクッとコンテナにマウントして検証したいとき。\n\n```bash\ndocker run  -v $(pwd):/work -w=/work -it [image name] [command]\n```\n\n#### 自前でVolumeを用意したくないとき\n\n```bash\ndocker volume create [volume name]\n```\n\n* https://docs.docker.com/storage/volumes/#start-a-container-with-a-volume\n\nMySQL 5.7を使ってたときに一瞬ハマったやつ\n\n* [mysql/5.7/docker-entrypoint.sh](https://github.com/docker-library/mysql/blob/master/5.7/docker-entrypoint.sh)\n* [MySQL 5.7のmysqld --initializeと鶏卵問題](http://d.hatena.ne.jp/hirose31/20161004/1475582156)\n* [--ignore-db-dir=dir_name](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_ignore-db-dir)\n\n### コンテナ内からホストへファイルをコピーする\n\n```\ndocker cp &lt;containerId&gt;:/file/path/within/container /host/path/target\n```\n\n* 参考\n    * [Dockerでホストとコンテナ間でのファイルコピー \\- Qiita](https://qiita.com/gologo13/items/7e4e404af80377b48fd5)\n    * [Copying files from Docker container to host \\- Stack Overflow](https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host)\n\n## 環境変数\n\ndocker-composeを使っている場合\n\n- https://docs.docker.com/compose/reference/envvars/\n- https://suin.io/535\n\n開発時はdirenvを利用することをオススメします。\n\n- https://github.com/direnv/direnv\n\n## Inspector\n\nhttps://docs.docker.com/engine/reference/commandline/ps/#filtering\n\n### --formatコマンド\n\n```bash\n# NAME CONTAINER_ID IMAGE\ndocker ps --format \&quot;table {{.Names}}\\t{{.ID}}\\t{{.Image}}\&quot;\n\n# NAME CONTAINER_ID IP\ndocker inspect --format &#x27;{{ .NetworkSettings.IPAddress }}&#x27; [CONTAINER NAME]\n\n# NAME CONTAINER_ID IMAGE\ndocker ps --format \&quot;table {{.Names}}\\t{{.ID}}\\t{{.Image}}\\t{{.Networks}}\\t\&quot;\n```\n\n### ネットワークの調査\n\n```bash\n$ docker inspect -f &#x27;{{.State.Pid}}&#x27; [container_name_or_id]\n```\n\n* [netstat \\- Docker: any way to list open sockets inside a running docker container? \\- Stack Overflow](https://stackoverflow.com/questions/40350456/docker-any-way-to-list-open-sockets-inside-a-running-docker-container)\n&quot;,&quot;metaData&quot;:{&quot;lang&quot;:&quot;ja&quot;,&quot;title&quot;:&quot;Dockerで利用するコマンド例&quot;,&quot;description&quot;:&quot;コピペで動くコマンドを書き連ねる&quot;,&quot;keywords&quot;:&quot;docker,shortcut&quot;,&quot;copyright&quot;:&quot;@Himenon&quot;,&quot;viewport&quot;:{&quot;initial-scale&quot;:1,&quot;minimum-scale&quot;:0.5,&quot;user-scalable&quot;:&quot;no&quot;},&quot;thirdParty&quot;:{&quot;googleAnalytics&quot;:{&quot;ua&quot;:&quot;UA-55455343-7&quot;}},&quot;js&quot;:[],&quot;css&quot;:[&quot;https://fonts.googleapis.com/css?family=Open+Sans:600,800&quot;,&quot;./node_modules/prismjs/themes/prism.css&quot;,&quot;/assets/stylesheets/styles.css&quot;],&quot;link&quot;:[{&quot;rel&quot;:&quot;apple-touch-icon&quot;,&quot;sizes&quot;:&quot;180x180&quot;,&quot;href&quot;:&quot;assets/images/miku.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;32x32&quot;,&quot;href&quot;:&quot;assets/images/favicon-32x32.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;16x16&quot;,&quot;href&quot;:&quot;assets/images/favicon-16x16.png&quot;}],&quot;createdAt&quot;:&quot;2018-09-13T04:06:08.000Z&quot;,&quot;updatedAt&quot;:&quot;2019-05-21T09:35:05.000Z&quot;,&quot;globalScripts&quot;:[],&quot;globalLinks&quot;:[{&quot;rel&quot;:&quot;apple-touch-icon&quot;,&quot;sizes&quot;:&quot;180x180&quot;,&quot;href&quot;:&quot;/assets/images/miku.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;32x32&quot;,&quot;href&quot;:&quot;/assets/images/favicon-32x32.png&quot;},{&quot;rel&quot;:&quot;icon&quot;,&quot;type&quot;:&quot;image/png&quot;,&quot;sizes&quot;:&quot;16x16&quot;,&quot;href&quot;:&quot;/assets/images/favicon-16x16.png&quot;},&quot;https://fonts.googleapis.com/css?family=Open+Sans:600,800&quot;,&quot;/lib/prism.css&quot;,&quot;/assets/stylesheets/styles.css&quot;],&quot;localLinks&quot;:[],&quot;extend&quot;:{&quot;meta&quot;:[{&quot;name&quot;:&quot;twitter:card&quot;,&quot;content&quot;:&quot;summary&quot;},{&quot;name&quot;:&quot;twitter:site&quot;,&quot;content&quot;:&quot;@Himenon&quot;},{&quot;property&quot;:&quot;og:title&quot;,&quot;content&quot;:&quot;Dockerで利用するコマンド例&quot;},{&quot;property&quot;:&quot;og:url&quot;,&quot;content&quot;:&quot;https://himenon.github.io/docker/command&quot;},{&quot;property&quot;:&quot;og:description&quot;,&quot;content&quot;:&quot;コピペで動くコマンドを書き連ねる&quot;},{&quot;property&quot;:&quot;og:image&quot;,&quot;content&quot;:&quot;https://himenon.github.io/assets/images/miku.png&quot;}]}},&quot;ext&quot;:&quot;.md&quot;,&quot;filename&quot;:&quot;src/docker/command.md&quot;,&quot;name&quot;:&quot;docker/command&quot;,&quot;raw&quot;:&quot;---\ntitle: \&quot;Dockerで利用するコマンド例\&quot;\ndescription: \&quot;コピペで動くコマンドを書き連ねる\&quot;\nkeywords: \&quot;docker,shortcut\&quot;\ncreatedAt: 2018-09-13 04:06:08\nupdatedAt: 2019-05-21 09:35:05\n---\n\n使っているときは、こんなの覚えているし（笑）\nと思っていたんですが、3か月使わなくなって忘れてしまったので、メモ帳から取り出します。\n\n## 起動中のコンテナプロセスの確認\n\n```bash\ndocker ps\n# sizeも表示する場合\ndocker ps -s\n```\n\n```bash\ndocker-compose ps\n```\n\n\n## コンテナ内でコマンドの実行\n\n```bash\ndocker exec -it [container id] [command]\n\n# ユーザーを指定\ndocker exec -it --user [desired_user] [container id] [command]\n```\n\n```bash\n# 起動していない場合\ndocker-compose run [container name] [command]\n\n# すでに起動している場合\ndocker-compose exec [container name] [command]\n```\n\n### 検証用に一発コマンドでpureな環境に入る\n\n```bash\ndocker run -it --rm alpine:3.3 /bin/sh\ndocker run -it --rm centos:7 /bin/bash\ndocker run -it --rm ubuntu:14.04 /bin/bash\n```\n\n\n* 参考：[Ubuntu や Alpine Linux をワンコマンドで瞬時に立ち上げる](https://qiita.com/dtan4/items/3be396665f9305428f4f)\n\n## イメージの停止・削除\n\n### すべてのdocker psを停止\n\n```bash\n# bash, zsh\ndocker stop $(docker ps -a -q)\n\n# fish\ndocker stop (docker ps -a -q)\n```\n\n### コンテナの削除\n\n```bash\ndocker rmi `docker images -q`\ndocker rm -f `docker ps -a -q`\n\n# fish\ndocker rm -f (docker ps -a -q)\n```\n\n### Docker psのNoneを消す\n\n```bash\n# bash\ndocker rmi $(docker images -f \&quot;dangling=true\&quot; -q)\n\n# fish\ndocker rmi (docker images -f \&quot;dangling=true\&quot; -q)\n\ndocker images | awk &#x27;/&lt;none/{print $3}&#x27; | xargs docker rmi\n```\n\n### docker-composeの場合\n\n```bash\ndocker-compose stop\ndocker-compose rm\n```\n\n## Volume系\n\n### データの永続化\n\n開発環境で、MySQLとかのバックアップ撮っておきたいなというとき。\n\n#### コンテナにホストのディレクトリをマウントする\n\n現在いるディレクトリをサクッとコンテナにマウントして検証したいとき。\n\n```bash\ndocker run  -v $(pwd):/work -w=/work -it [image name] [command]\n```\n\n#### 自前でVolumeを用意したくないとき\n\n```bash\ndocker volume create [volume name]\n```\n\n* https://docs.docker.com/storage/volumes/#start-a-container-with-a-volume\n\nMySQL 5.7を使ってたときに一瞬ハマったやつ\n\n* [mysql/5.7/docker-entrypoint.sh](https://github.com/docker-library/mysql/blob/master/5.7/docker-entrypoint.sh)\n* [MySQL 5.7のmysqld --initializeと鶏卵問題](http://d.hatena.ne.jp/hirose31/20161004/1475582156)\n* [--ignore-db-dir=dir_name](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_ignore-db-dir)\n\n### コンテナ内からホストへファイルをコピーする\n\n```\ndocker cp &lt;containerId&gt;:/file/path/within/container /host/path/target\n```\n\n* 参考\n    * [Dockerでホストとコンテナ間でのファイルコピー \\- Qiita](https://qiita.com/gologo13/items/7e4e404af80377b48fd5)\n    * [Copying files from Docker container to host \\- Stack Overflow](https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host)\n\n## 環境変数\n\ndocker-composeを使っている場合\n\n- https://docs.docker.com/compose/reference/envvars/\n- https://suin.io/535\n\n開発時はdirenvを利用することをオススメします。\n\n- https://github.com/direnv/direnv\n\n## Inspector\n\nhttps://docs.docker.com/engine/reference/commandline/ps/#filtering\n\n### --formatコマンド\n\n```bash\n# NAME CONTAINER_ID IMAGE\ndocker ps --format \&quot;table {{.Names}}\\t{{.ID}}\\t{{.Image}}\&quot;\n\n# NAME CONTAINER_ID IP\ndocker inspect --format &#x27;{{ .NetworkSettings.IPAddress }}&#x27; [CONTAINER NAME]\n\n# NAME CONTAINER_ID IMAGE\ndocker ps --format \&quot;table {{.Names}}\\t{{.ID}}\\t{{.Image}}\\t{{.Networks}}\\t\&quot;\n```\n\n### ネットワークの調査\n\n```bash\n$ docker inspect -f &#x27;{{.State.Pid}}&#x27; [container_name_or_id]\n```\n\n* [netstat \\- Docker: any way to list open sockets inside a running docker container? \\- Stack Overflow](https://stackoverflow.com/questions/40350456/docker-any-way-to-list-open-sockets-inside-a-running-docker-container)\n&quot;},&quot;site&quot;:{&quot;title&quot;:&quot;himenon.github.io&quot;,&quot;description&quot;:&quot;早く画面から出たい人の備忘録。&quot;,&quot;baseUri&quot;:&quot;/&quot;,&quot;baseUrl&quot;:&quot;https://himenon.github.io&quot;}}"></script>
  </head>

  <body>

    <body>
      <div>
        <nav id="nav-bar">
          <div id="nav-bar-container"><a href="/">TOP</a></div>
        </nav>
        <header id="site-header">
          <div id="site-header-container">
            <h1 id="page-title">Dockerで利用するコマンド例</h1>
            <p id="page-description">コピペで動くコマンドを書き連ねる</p>
            <p id="article-time"><span id="posted-at__label">投稿日</span><time>2018-09-13 01:06:08</time><span id="created-at__label">更新日</span><time>2019-05-21 06:35:05</time></p>
          </div>
        </header>
      </div>
      <div class="wrapper">
        <section>
          <p>使っているときは、こんなの覚えているし（笑）
            と思っていたんですが、3か月使わなくなって忘れてしまったので、メモ帳から取り出します。</p>
          <h2>起動中のコンテナプロセスの確認</h2><pre class="language-bash"><code class="language-bash">docker <span class="token function">ps</span>
<span class="token comment"># sizeも表示する場合</span>
docker <span class="token function">ps</span> -s
</code></pre><pre class="language-bash"><code class="language-bash">docker-compose <span class="token function">ps</span>
</code></pre>
          <h2>コンテナ内でコマンドの実行</h2><pre class="language-bash"><code class="language-bash">docker <span class="token function">exec</span> -it <span class="token punctuation">[</span>container id<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

<span class="token comment"># ユーザーを指定</span>
docker <span class="token function">exec</span> -it --user <span class="token punctuation">[</span>desired_user<span class="token punctuation">]</span> <span class="token punctuation">[</span>container id<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>
</code></pre><pre class="language-bash"><code class="language-bash"><span class="token comment"># 起動していない場合</span>
docker-compose run <span class="token punctuation">[</span>container name<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

<span class="token comment"># すでに起動している場合</span>
docker-compose <span class="token function">exec</span> <span class="token punctuation">[</span>container name<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>
</code></pre>
          <h3>検証用に一発コマンドでpureな環境に入る</h3><pre class="language-bash"><code class="language-bash">docker run -it --rm alpine:3.3 /bin/sh
docker run -it --rm centos:7 /bin/bash
docker run -it --rm ubuntu:14.04 /bin/bash
</code></pre>
          <ul>
            <li>参考：<a href="https://qiita.com/dtan4/items/3be396665f9305428f4f">Ubuntu や Alpine Linux をワンコマンドで瞬時に立ち上げる</a></li>
          </ul>
          <h2>イメージの停止・削除</h2>
          <h3>すべてのdocker psを停止</h3><pre class="language-bash"><code class="language-bash"><span class="token comment"># bash, zsh</span>
docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span>

<span class="token comment"># fish</span>
docker stop <span class="token punctuation">(</span>docker <span class="token function">ps</span> -a -q<span class="token punctuation">)</span>
</code></pre>
          <h3>コンテナの削除</h3><pre class="language-bash"><code class="language-bash">docker rmi <span class="token variable"><span class="token variable">`</span>docker images -q<span class="token variable">`</span></span>
docker <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">`</span>docker <span class="token function">ps</span> -a -q<span class="token variable">`</span></span>

<span class="token comment"># fish</span>
docker <span class="token function">rm</span> -f <span class="token punctuation">(</span>docker <span class="token function">ps</span> -a -q<span class="token punctuation">)</span>
</code></pre>
          <h3>Docker psのNoneを消す</h3><pre class="language-bash"><code class="language-bash"><span class="token comment"># bash</span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images -f <span class="token string">"dangling=true"</span> -q<span class="token variable">)</span></span>

<span class="token comment"># fish</span>
docker rmi <span class="token punctuation">(</span>docker images -f <span class="token string">"dangling=true"</span> -q<span class="token punctuation">)</span>

docker images <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/&lt;none/{print <span class="token variable">$3</span>}'</span> <span class="token operator">|</span> <span class="token function">xargs</span> docker rmi
</code></pre>
          <h3>docker-composeの場合</h3><pre class="language-bash"><code class="language-bash">docker-compose stop
docker-compose <span class="token function">rm</span>
</code></pre>
          <h2>Volume系</h2>
          <h3>データの永続化</h3>
          <p>開発環境で、MySQLとかのバックアップ撮っておきたいなというとき。</p>
          <h4>コンテナにホストのディレクトリをマウントする</h4>
          <p>現在いるディレクトリをサクッとコンテナにマウントして検証したいとき。</p><pre class="language-bash"><code class="language-bash">docker run  -v <span class="token variable"><span class="token variable">$(</span><span class="token function">pwd</span><span class="token variable">)</span></span>:/work -w<span class="token operator">=</span>/work -it <span class="token punctuation">[</span>image name<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>
</code></pre>
          <h4>自前でVolumeを用意したくないとき</h4><pre class="language-bash"><code class="language-bash">docker volume create <span class="token punctuation">[</span>volume name<span class="token punctuation">]</span>
</code></pre>
          <ul>
            <li><a href="https://docs.docker.com/storage/volumes/#start-a-container-with-a-volume">https://docs.docker.com/storage/volumes/#start-a-container-with-a-volume</a></li>
          </ul>
          <p>MySQL 5.7を使ってたときに一瞬ハマったやつ</p>
          <ul>
            <li><a href="https://github.com/docker-library/mysql/blob/master/5.7/docker-entrypoint.sh">mysql/5.7/docker-entrypoint.sh</a></li>
            <li><a href="http://d.hatena.ne.jp/hirose31/20161004/1475582156">MySQL 5.7のmysqld --initializeと鶏卵問題</a></li>
            <li><a href="https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_ignore-db-dir">--ignore-db-dir=dir_name</a></li>
          </ul>
          <h3>コンテナ内からホストへファイルをコピーする</h3><pre class="language-plain"><code class="language-plain">docker cp &lt;containerId&gt;:/file/path/within/container /host/path/target
</code></pre>
          <ul>
            <li>参考<ul>
                <li><a href="https://qiita.com/gologo13/items/7e4e404af80377b48fd5">Dockerでホストとコンテナ間でのファイルコピー - Qiita</a></li>
                <li><a href="https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host">Copying files from Docker container to host - Stack Overflow</a></li>
              </ul>
            </li>
          </ul>
          <h2>環境変数</h2>
          <p>docker-composeを使っている場合</p>
          <ul>
            <li><a href="https://docs.docker.com/compose/reference/envvars/">https://docs.docker.com/compose/reference/envvars/</a></li>
            <li><a href="https://suin.io/535">https://suin.io/535</a></li>
          </ul>
          <p>開発時はdirenvを利用することをオススメします。</p>
          <ul>
            <li><a href="https://github.com/direnv/direnv">https://github.com/direnv/direnv</a></li>
          </ul>
          <h2>Inspector</h2>
          <p><a href="https://docs.docker.com/engine/reference/commandline/ps/#filtering">https://docs.docker.com/engine/reference/commandline/ps/#filtering</a></p>
          <h3>--formatコマンド</h3><pre class="language-bash"><code class="language-bash"><span class="token comment"># NAME CONTAINER_ID IMAGE</span>
docker <span class="token function">ps</span> --format <span class="token string">"table {{.Names}}\t{{.ID}}\t{{.Image}}"</span>

<span class="token comment"># NAME CONTAINER_ID IP</span>
docker inspect --format <span class="token string">'{{ .NetworkSettings.IPAddress }}'</span> <span class="token punctuation">[</span>CONTAINER NAME<span class="token punctuation">]</span>

<span class="token comment"># NAME CONTAINER_ID IMAGE</span>
docker <span class="token function">ps</span> --format <span class="token string">"table {{.Names}}\t{{.ID}}\t{{.Image}}\t{{.Networks}}\t"</span>
</code></pre>
          <h3>ネットワークの調査</h3><pre class="language-bash"><code class="language-bash">$ docker inspect -f <span class="token string">'{{.State.Pid}}'</span> <span class="token punctuation">[</span>container_name_or_id<span class="token punctuation">]</span>
</code></pre>
          <ul>
            <li><a href="https://stackoverflow.com/questions/40350456/docker-any-way-to-list-open-sockets-inside-a-running-docker-container">netstat - Docker: any way to list open sockets inside a running docker container? - Stack Overflow</a></li>
          </ul>
        </section>
      </div>
    </body>
  </body>

</html>