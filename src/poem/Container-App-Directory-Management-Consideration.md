# コンテナアプリケーション作成時のディレクトリ構造の考察

<p id="created_at">作成日: <time datetime="2018-03-15T22:40">2018/03/15 22:40</time></p>

## はじめに

Dockerを使ったWEBアプリケーションのディレクトリ構造を考えていきます。

### 提起

PCを使う上で、我々の扱うデータはディレクトリ構造の中に格納されています。
アプリケーション開発は、コーディングして、バージョン管理し、デプロイまで
行って初めてユーザーに届きます。
時が経過するに連れて、使用する技術やサービスの規模感が変わってきますが、
ディレクトリ構造の初期設計次第で、迅速に対応できるかどうかが決まってくると考えられます。

### 課題

マイクロサービスアプリケーションにおける、
コンテナを用いたアプリケーションの
ディレクトリ設計の考察を具体的に行う。

### 方向性

「UNIXという考え方―その設計思想と哲学」の本に乗っ取り、
以下のことを目標に考えていきます。

- 小さく作る
- 1つのプログラムには1つのことだけをやらせる
- 試作が早く作れる状態にする
- 効率より移植性を取る
- すべてのプログラムをフィルタにする

これから外れる考えのものははじく方針で行います。

## 定義

要件定義を予めしておきます。
(問題の抽象度とここの具体度がかけ離れすぎなので、気が向いたら調整)

1. WEBアプリケーションを作成する
1. 言語はPythonとする
1. 開発環境はDockerを用いる
1. デプロイ先はKubernetesとする
1. KubernetesはHelmによって管理する
1. CI/CDを用いて、自動テスト、自動デプロイを行う
1. コードはGithubで管理する
1. テスト駆動を行う
1. ドキュメントを必ず残す
1. マイクロサービスアーキテクチャを採用する

TODO: 箇条書きのテイストを調整

※ 具体的なコードを扱うわけではありませんが、わかりやすさのため。

### 発散させる

要件を満たすように、WEBアプリケーションを育ててみます。
その時のファイル構造、ディレクトリ構造の変化を見ていきます。

#### 1. 小さなWEBアプリケーションを作成する

WEBアプリケーション

```
+ server.py
```

#### 2. テストコードを追加する

```
  server.py
+ test_server.py
```

#### 3. ドキュメントを追加する

```
  server.py
  test_server.py
  docs/
```

#### 4. CIの設定を組み込む

```
+ .ci_settings
  server.py
  test_server.py
  docs/
```

#### 5. コンテナ化する

```
  ci_settings
+ Dockerfile
  server.py
  test_server.py
  docs/
```


#### 3.






