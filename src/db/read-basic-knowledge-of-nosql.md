# NOSQLとは何か... 

<p id="created_at">作成日: <time datetime="2018-02-24T23:00">2018/02/24</time></p>

NOSQLの知識が欲しかったので、ちょっと古いが次の本を読んだ。

> **NOSQLの基礎知識 (ビッグデータを活かすデータベース技術)**
>
>- 作者: 本橋信也,河野達也,鶴見利章,太田洋
>- 出版社/メーカー: リックテレコム
>- 発売日: 2012/04/25
>- http://www.ric.co.jp/book/contents/book_887.html

逆引き的に自分なりにまとめておく。

ただし、出版日が数年前なだけあって、既に古いと思われる部分はなるべく書かないか、
明記しておく。

## 逆引き

### ビッグデータ

小さなデータが膨大に集まって、全体として大きなデータとなっているもの

### ラージオブジェクト

1つのファイルサイズが大きいもの

### 結果整合性

ビッグデータ環境

### SQL

行と列で構成されるテーブル形

- MySQL
- Postgres

### KVS

KeyとValueの組からなるデータ

- Redis
- Dynamo

### カラム指向型

Key/Value形式を拡張したもので、行だけでなく、列に対して
動的に追加することができる。

- BigTable

### ドキュメント思考型

JSON、BSOM、XMLといったデータ記述書式で記されたドキュメント型

- CouchDB
- MongoDB

### スケールアップ

サーバーのハードウェア自体の強化

### スケールアウト

サーバー自体の数を増やす

### シャーディング

複数のサーバーにデータを分割する方法

### CAP定理

- **C**onsistency: 整合性
- **A**vailability: 可用性
- **P**artitions: 分断耐性

分散システムにおいて、C、A、Pの3つのうち最大で2つしか満たすことができない、という定理

[CAP定理 - Wikipedia](https://ja.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86)

### ACID

トランザクションの実行保証をするために、
データベースに求められる4つの特性

- **A**tomicity（原子性）
- **C**onsistency（一貫性）
- **I**solation（独立性）
- **D**urability（耐久性）

[ACID (コンピュータ科学) - Wikipedia](https://ja.wikipedia.org/wiki/ACID_(%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E7%A7%91%E5%AD%A6))

### BASE

> BASEとは、「アプリケーションは基本的にどんなときでも動き(Basicallly Available)、常に整合性を保つ必要はないが(Soft-state)、結果として整合性がとれる状態に至る(Eventual Consistency)という特性」<br />
> p83

- **B**asically **A**vailable
- **S**oft-state
- **E**ventual Consistencty

### Quorum(クォーラム)

議決に必要な定足数。

- N: レプリカの数
- R: ノードから読み出す数
- W: ノードに書き込む数

```
R + W > Nの場合には整合性が保証できる。
```

`R+W`がノード数より大きい場合、**結果的に**書き込みが完了したデータを読み込むことができる、ということ。

### ベクタークロック(Vector Clocks)/タイムスタンプ(Timestamp)

複数のクライアントからの同時更新があった場合に、
どのようにデータのバージョンを管理し、最終的な仲裁を行うか、
という課題に対する、代表的な解決方法。

**タイムスタンプ**

- 「新しいものが勝つ」という方法。
- サーバー側、クライアント側のどちらでも決定して良い。

**ベクタークロック**

整合性を確保する際に用いる手法の1つ。

- http://www.atmarkit.co.jp/ait/articles/1211/05/news007_3.html


### コンシステント・ハッシング(Consistent Hashing)

ノードをリング状に配置し、ハッシュ値を元に
それらのノードに書き込みを行っていく方法。
キーの値が特定の値に偏ることなく拡散するようにする。

